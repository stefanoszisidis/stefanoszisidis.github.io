<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Music - RunTheCode.gr</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <style>
    /* Additional styles for playlist selection */
    .year-selector {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }

    .year-btn {
      padding: 0.75rem 1.5rem;
      background-color: rgba(56, 189, 248, 0.1);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: 500;
    }

    .year-btn:hover {
      background-color: rgba(56, 189, 248, 0.2);
      border-color: var(--accent-primary);
    }

    .year-btn.active {
      background-color: var(--accent-primary);
      border-color: var(--accent-primary);
      color: var(--bg-body);
    }

    .quarter-selector {
      display: flex;
      gap: 0.75rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }

    .quarter-btn {
      padding: 0.5rem 1rem;
      background-color: var(--bg-body);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 0.9rem;
    }

    .quarter-btn:hover {
      background-color: rgba(56, 189, 248, 0.1);
      border-color: var(--accent-primary);
      color: var(--text-primary);
    }

    .quarter-btn.active {
      background-color: rgba(56, 189, 248, 0.15);
      border-color: var(--accent-primary);
      color: var(--accent-primary);
      font-weight: 600;
    }

    .playlist-section {
      display: none;
    }

    .playlist-section.active {
      display: block;
    }
  </style>
</head>

<body>
  <header class="site-header">
    <div class="container">
      <a href="index.html" class="site-title">RunTheCode.gr</a>
      <nav class="breadcrumb">
        <a href="index.html">Home</a>
        <span class="separator">/</span>
        <span class="current">Music</span>
      </nav>
    </div>
  </header>

  <main>
    <section class="music-hero">
      <div class="container">
        <h1>Music</h1>
        <p class="music-subtitle">Curated quarterly playlists featuring handpicked tracks</p>
      </div>
    </section>

    <section class="playlist-info">
      <div class="container">
        <div class="info-card">
          <h2>Quarterly Music Collections</h2>
          <p>Every three months, I curate a special playlist of songs that resonated with me during that period.
            Each collection represents a musical journey through the quarter, featuring tracks across various genres and
            moods.</p>

          <!-- Year Selection -->
          <div class="year-selector">
            <button class="year-btn active" data-year="2025">2025</button>
            <button class="year-btn" data-year="2023">2023</button>
          </div>

          <!-- Quarter Selection (dynamically populated) -->
          <div id="quarter-selector" class="quarter-selector"></div>

          <p class="current-playlist" style="margin-top: 1.5rem;">
            Currently selected: <strong><span id="selected-playlist">2025 Q3 Playlist</span></strong>
          </p>
        </div>
      </div>
    </section>

    <section class="music-content">
      <div class="container">
        <div class="playlist-grid">
          <div class="video-container">
            <div class="video-wrapper">
              <iframe id="youtube-player" width="560" height="315"
                src="https://www.youtube.com/embed/videoseries?list=PLo5Dkz0iHmDjyhVfhAOGAzSgviW63XW2Y&enablejsapi=1"
                frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
            </div>
          </div>

          <div class="tracklist-container">
            <h3>Tracklist</h3>
            <div id="tracklist" class="tracklist">
              <!-- Tracks will be dynamically loaded -->
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p>&copy; 2025 RunTheCode.gr Team</p>
    </div>
  </footer>

  <script>
    // Playlist data structure
    const playlists = {
      "2025": {
        "Q3": {
          id: "PLo5Dkz0iHmDjyhVfhAOGAzSgviW63XW2Y",
          name: "2025 Q3 Playlist",
          tracks: [
            "Track 1",
            "Track 2",
            "Track 3",
            "Track 4",
            "Track 5",
            "Track 6",
            "Track 7",
            "Track 8",
            "Track 9",
            "Track 10"
          ]
        }
      },
      "2023": {
        "Q1": {
          id: "PLo5Dkz0iHmDiCw7fQ3vY3V5Sb7Z26VlQO",
          name: "2023 Q1 Playlist",
          tracks: [
            "Kowloon - Wake Up",
            "Everything But The Girl - Nothing Left To Lose",
            "Lidj Incorporated - General Penitentiary",
            "Vasilis Kostas - To Horio (The Village)",
            "Cable Ties - Say What You Mean",
            "Sleaford Mods - UK GRIM",
            "Young Fathers - Tell Somebody",
            "Young Fathers - Rice",
            "Jan Van Angelopoulos & Fotis Siotas - Watching it from Distance",
            "Pavlos Pavlidis - I Mairi",
            "Deaf Radio - Arsenal of Hope",
            "Luude & Issey Cross - Oh My",
            "Rival Sons - Bird In The Hand",
            "Fontaines D.C. - 'Cello Song",
            "Slomosa - There is Nothing New Under the Sun",
            "Track 16",
            "Track 17"
          ]
        }
      }
    };

    // YouTube IFrame API
    let player;
    let isAPIReady = false;
    let updateInterval;
    let lastPlayingIndex = -1;
    let currentYear = "2025";
    let currentQuarter = "Q3";

    // Load YouTube IFrame API
    const tag = document.createElement('script');
    tag.src = 'https://www.youtube.com/iframe_api';
    const firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    // Initialize UI
    function initializeUI() {
      updateQuarterButtons(currentYear);
      loadPlaylist(currentYear, currentQuarter);
      setupYearButtons();
    }

    // Setup year button handlers
    function setupYearButtons() {
      const yearButtons = document.querySelectorAll('.year-btn');
      yearButtons.forEach(btn => {
        btn.addEventListener('click', function () {
          const year = this.dataset.year;

          // Update active state
          yearButtons.forEach(b => b.classList.remove('active'));
          this.classList.add('active');

          // Update current year and show quarters
          currentYear = year;
          updateQuarterButtons(year);

          // Auto-select first available quarter
          const quarters = Object.keys(playlists[year]);
          if (quarters.length > 0) {
            currentQuarter = quarters[0];
            loadPlaylist(year, currentQuarter);
          }
        });
      });
    }

    // Update quarter buttons based on selected year
    function updateQuarterButtons(year) {
      const quarterSelector = document.getElementById('quarter-selector');
      quarterSelector.innerHTML = '';

      const quarters = playlists[year];
      if (!quarters) return;

      Object.keys(quarters).forEach((quarter, index) => {
        const btn = document.createElement('button');
        btn.className = 'quarter-btn';
        btn.textContent = quarter;
        btn.dataset.quarter = quarter;

        if (quarter === currentQuarter) {
          btn.classList.add('active');
        }

        btn.addEventListener('click', function () {
          const quarterBtns = document.querySelectorAll('.quarter-btn');
          quarterBtns.forEach(b => b.classList.remove('active'));
          this.classList.add('active');

          currentQuarter = quarter;
          loadPlaylist(currentYear, quarter);
        });

        quarterSelector.appendChild(btn);
      });
    }

    // Load a specific playlist
    function loadPlaylist(year, quarter) {
      const playlist = playlists[year][quarter];
      if (!playlist) return;

      // Update selected playlist text
      document.getElementById('selected-playlist').textContent = playlist.name;

      // Load tracks
      const tracklistDiv = document.getElementById('tracklist');
      tracklistDiv.innerHTML = '';

      playlist.tracks.forEach((track, index) => {
        const trackItem = document.createElement('div');
        trackItem.className = 'track-item';
        trackItem.dataset.index = index;

        const trackNumber = document.createElement('span');
        trackNumber.className = 'track-number';
        trackNumber.textContent = String(index + 1).padStart(2, '0');

        const trackName = document.createElement('span');
        trackName.className = 'track-name';
        trackName.textContent = track;

        trackItem.appendChild(trackNumber);
        trackItem.appendChild(trackName);
        tracklistDiv.appendChild(trackItem);
      });

      // Load YouTube playlist
      if (player && player.loadPlaylist) {
        player.loadPlaylist({
          list: playlist.id,
          listType: 'playlist',
          index: 0
        });
        lastPlayingIndex = -1;
      } else {
        // Update iframe source
        const iframe = document.getElementById('youtube-player');
        iframe.src = `https://www.youtube.com/embed/videoseries?list=${playlist.id}&enablejsapi=1`;
      }

      // Re-setup click handlers for tracks
      setupTrackClickHandlers();
    }

    // Setup track click handlers
    function setupTrackClickHandlers() {
      const trackItems = document.querySelectorAll('.track-item');
      trackItems.forEach(trackItem => {
        trackItem.addEventListener('click', function () {
          const trackIndex = parseInt(this.getAttribute('data-index'));

          // Play the selected track
          if (player && player.playVideoAt) {
            player.playVideoAt(trackIndex);
          }
        });
      });
    }

    // Function to update active track highlight
    function updateActiveTrack() {
      if (!player || !player.getPlaylistIndex) return;

      try {
        const currentIndex = player.getPlaylistIndex();
        const trackItems = document.querySelectorAll('.track-item');

        // Remove active class from all tracks
        trackItems.forEach(item => item.classList.remove('active'));

        // Add active class to currently playing track
        const currentTrack = document.querySelector(`.track-item[data-index="${currentIndex}"]`);
        if (currentTrack) {
          currentTrack.classList.add('active');

          // Only scroll if the track has changed
          if (currentIndex !== lastPlayingIndex) {
            currentTrack.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            lastPlayingIndex = currentIndex;
          }
        }
      } catch (error) {
        // Silently handle errors (player might not be ready)
      }
    }

    // Called when API is ready
    function onYouTubeIframeAPIReady() {
      isAPIReady = true;
      player = new YT.Player('youtube-player', {
        events: {
          'onReady': onPlayerReady,
          'onStateChange': onPlayerStateChange
        }
      });
    }

    function onPlayerReady(event) {
      setupTrackClickHandlers();

      // Start polling for current track (every 500ms)
      updateInterval = setInterval(updateActiveTrack, 500);

      // Initial update
      updateActiveTrack();
    }

    function onPlayerStateChange(event) {
      // Update immediately when state changes
      updateActiveTrack();
    }

    // Fallback if API doesn't load
    window.addEventListener('load', function () {
      setTimeout(function () {
        if (!isAPIReady) {
          console.log('YouTube API not loaded, using basic functionality');
          setupTrackClickHandlers();
        }
      }, 3000);
    });

    // Clean up interval when page unloads
    window.addEventListener('beforeunload', function () {
      if (updateInterval) {
        clearInterval(updateInterval);
      }
    });

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', initializeUI);
  </script>
</body>

</html>